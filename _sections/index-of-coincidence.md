Imagine starting with some text consisting of only uppercase alphabet characters. Separate all of the letters from each other. Throw them all into in a bag to shuffle them up. Then draw two letters from it without replacement. What is the probability that the two letters you drew are the same? 

Let $N$ be the total number of letters in the bag. For each letter $\alpha$, let $N_\alpha$ be the number of times that $\alpha$ appears in the bag. Then $N_\alpha/N$ is the probability that $\alpha$ is the first letter you draw from the bag. After you draw that letter, there are $N-1$ letters left in the bag and $\alpha$ occurs only $N_\alpha-1$ times, so the probability of drawing $\alpha$ again is $(N_\alpha-1)/(N-1)$. Thus the overall probability of drawing $\alpha$ twice is
$$ \frac{N_\alpha(N_\alpha - 1)}{N(N-1)}. $$
Our question we posed in the first paragraph, however, was not about the probability that we draw $\alpha$ from the bag twice. It was about drawing two of the same letter, which can be any letter. This means we have to sum over all of the possible choices of $\alpha$. In other words, the probability we're looking for is actually
$$ \sum_{\alpha \in \{\text{A}, \dotsc, \text{Z}\}} \frac{N_\alpha(N_\alpha - 1)}{N(N-1)}. $$
There is one step we did above that you should justify to yourself before proceeding: 

<div class="element">
<span class="label">Exercise</span>
Above we stated that the probability of drawing $\alpha$ for our first letter is $N_\alpha/N$ and the probability of drawing $\alpha$ for our second letter is $(N_\alpha-1)/(N-1)$, so the probability of drawing two $\alpha$'s in a row is the product of these. Justify this "multiplication" of probabilities using conditional probabilities. 

*Hint*. Consider the experiment of drawing two letters from the bag. Let $A_\alpha$ be the event that the first letter is $\alpha$ and $B_\alpha$ the event that the second letter is $\alpha$. What is $P(A_\alpha)$? What is $P(B_\alpha \mid A_\alpha)$?
</div>

Since there are 26 letters in the English alphabet, it turns out to be convenient to normalize this probability we computed above by multiplying by 26. The resulting number gets a special name: 

<div class="element">
<span class="label">Definition</span>
Let $N$ be the length of some text and, for each letter $\alpha$, let $N_\alpha$ be the number of times $\alpha$ occurs in this text. The *index of coincidence* of the text, denoted $\mathrm{IC}$, is the number 
$$ \mathrm{IC} = 26 \sum_{\alpha \in \{\text{A}, \dotsc, \text{Z}\}} \frac{N_\alpha(N_\alpha - 1)}{N(N-1)}. $$
</div>

Here are some exercises to help you play with this definition. 

<div class="element">
<span class="label">Exercise</span>
Suppose that you start with a text where *every letter appears equally often*. What would the index of coincidence of such a text be?
</div>

<div class="element">
<span class="label">Exercise</span>
What is the largest possible index of coincidence? What kind of text would result in an index of coincidence that's as large as possible? 
</div>

<div class="element" id="important-ic-exercise">
<span class="label">Important Exercise</span>
Let $N$ be the length of some text and, for each letter $\alpha$, let $N_\alpha$ be the number of times $\alpha$ occurs in this text. Let $p_\alpha = N_\alpha/N$. Show that, if $N$ is very large, then  
$$ \mathrm{IC} \approx 26 \sum_{\alpha \in \{\text{A}, \dotsc, \text{Z}\}} p_\alpha^2. $$ 
</div>

As we've seen, relative frequencies of letters in English are roughly stable from text to text, at least for sufficiently long texts. Correspondingly, the index of coincidence is also roughly stable from text to text! Here is the relevant heuristic: 

<div class="element">
<span class="label">Heuristic</span>
The index of coincidence of long English plaintext is (a) typically around 1.75, and (b) almost always between 1.5 and 2.
</div>

<div class="element" id="sagecell-index-of-coincidence-comparison">
<span class="label">SageCell</span>
Here is a SageCell to help convince you of the above heuristic. You'll see several input boxes which default to passages from Emily Br√∂nte's *Wuthering Heights*, the Declaration of Independence, F. Scott Fitzgerald's *The Great Gatsby*, and the Preamble to the Universal Declaration of Human Rights. The code outputs a table indicating the index of coincidence of each of these texts. 

* Does the above heuristic hold up for this data? 

* Edit the texts to texts of your choice and see what happens! In particular, roughly how short can the texts be before the heuristic starts to break down? 

<div class="sage">
<script type="text/x-sage">
from re import sub
from collections import Counter

samples = ["""{{ wuthering }}""",
           """{{ declaration }}""", 
           """{{ gatsby }}""",
           """{{ udhr }}"""]

# Remove all non alphabetic characters and capitalize
def encode(text: str):
    stripped = sub(r"[^a-zA-Z]", "", text)
    return stripped.upper()

# Calculate index of coincidence of given text    
def coincidence(text: str):
    n = len(text)
    c = Counter(text)
    return 26.0 * sum([(m*(m-1))/(n*(n-1)) for x, m in c.items()])

# Prints an output div aligning with the interact controls   
def output_div(label: str, content: str):
    s = '<div class="sagecell_interactControlCell" style="width: 100%;">'
    s += f'<label class="sagecell_interactControlLabel">{label}</label>'
    s += f'<div class="sagecell_interactControl">{content}</div>'
    s += '</div>'
    pretty_print(html(s))

@interact
def _(text1=input_box(default=samples[0], label="Text 1", height=5, width=70),
      text2=input_box(default=samples[1], label="Text 2", height=5, width=70),
      text3=input_box(default=samples[2], label="Text 3", height=5, width=70),
      text4=input_box(default=samples[3], label="Text 4", height=5, width=70)):
    
    texts = [text1, text2, text3, text4]
    texts = [encode(s) for s in texts]
    for i, s in enumerate(texts):
        output_div(f"IC {i+1}", f"{coincidence(s):.2f}")
    
</script>
</div>
</div>

Based on the Important Exercise above, we know that 
$$ \mathrm{IC} \approx 26 \sum_{\alpha \in \{\text{A}, \dotsc, \text{Z}\}} p_\alpha^2. $$
Notice that the right-hand side stays exactly the same if we perform a simple substitution on our text! For example, suppose the letter `E` has a relative frequency of 13% in some plaintext. Then $p_{\text{E}}^2 \approx 0.13^2$ will appear as a summand in the above expression for the $\mathrm{IC}$ of this plaintext. If we perform a simple substitution that converts the letter `E` to something else, say `Q`, then $p_{\text{Q}}^2 \approx 0.13^2$ will appear as a summand of the $\mathrm{IC}$ for the ciphertext. The subcript is different, but the value is exactly the same! Since we're summing over all of the letters, the value of $\mathrm{IC}$ does not change when we perform a simple substitution. 

<div class="element">
<span class="label">Exercise</span>
Suppose some English plaintext is encrypted using a transposition cipher (eg, rectangular transposition). How will the index of coincidence of the plaintext compare to that of the ciphertext? 
</div>

This suggests that the index of coincidence can be used as a test to determine whether text encrypted using an unknown cipher involved a non-simple substitution. If no non-simple substitution was involved, we should see an index of coincidence that matches what's expected of English plaintext based on the above heuristic. Otherwise, there should be some discrepancy!

{% capture gatsby_hill %}SGPPZNQPEYKUOWMOVXDKKKFSMWDJDRPNBITQYUZRMOQBLLYRSYBKGVAVIMNNYRQBSGAYYVOYVPAXTQYHUFEDPVTXJNYVTQCVUHHLAIVPTXLUSIEKPFHTTPOVTQUGZQZRRBYUMDECKLXBUXOVUPJTZDRZZRAQBXNVANNEGSZQYVIKXJEDQFUTVHDLKLOWQPECXBRSGFSZQEYEANVTMDEZWSTXLUYQKWNVEWTQMRKYHKAXTQMEKQEDMRFTTIBRNOEBQPABGVKMRFKWHNVDCHEYVXFTDKLLEMOJEDEDZQOWZQHNDJIPKLANZHQRGSRFXAWOCTMRKYCRAXBIDJNIQEDRGTMRDZEUMDQJJDULKYHKSWNAECWSTJLDGCSQYHXBKUOFMEAQZDJDVSXPZDTPLUGKEMDCIEWYHTEATQSOEMBZBZFCGBVHVXIWETTZVXDKDJIPTQKKSQCWANVGDJHLUKHKUTPFYVFTTIYVOEMOANPCBLYJIESGFMMRANVGDJGCJNUAYVGQTPTILXOJLLINPVTXQBMRKYHKEDEDDJIPYGMDUTYILZIPTQUTMETICSEAPPXPGDPPOVUPMDLLMBBLZQOVQFEZUXEDEDZQYVTXOVKYMDQFBLDBZAKCXRKWEMSOFJNNTBQWOVCTELGVLDMRSYWMMDTQUGTIEMBIDJMELUVHTIZHJQZLPHAZVHRWDJTPLUMWKWGFUTQBTQIDKWFGKYHKEATQGYNIIHILEOMMJDTIGYGCJNMNVGCRDJAVUCUTQGMRHNTXZRTIJFKGSZMDTQMDJRAIYVIWDJHTZQPFUHQJOYPFXBSQOYRBKKYDOYZQDJCTKLWANVDLANSVGGMRECYDTZORSYPNLKEUOUOLMAEATQEBGKOEAXLQCWOGHNWJEYJHPNIPDXYVTQKKSIJMKYHKANZHUTKWSZKLRSSYYVQMEUXBUTKWJTZDDXWZQBEJDJOVQBYHDJDROWTIUTSZLXOJHNTQOLMEUZANTZBESYPNLXUXQBTQWAANHJAKHNBIDJTFCCXBHTPOEOWAWYHTCBAKSZPHOWTITQUTECUTABIPFCUYJZXPGDPPGJOEFSTQWAVHLXKIMGBZZDOFIMAXKJUTVDFVMDEOBLMOTQWAEYTIANJDOVDJMGQBBLKULLGDUTTQCIVPMOMRVXWZXBSQWALDSGZQOUIDFTOWIIZQUHAVGVIUDKKCLDGCSOSYIPOYBIDJMNZHYRANXAUTYHVHPCJFWYHTLXRBWNYDXNJHFDQEJFJNIQWAKJHTQPAVUGPUHTKWHNBIDJVPGUYDNGKLSJANIEDJVGHTWATQYHHTWATQMDVHHJGVECWMRZLHMDEZEUXBSQABGVQBOETPTIUTSZYVCTIEBRJNHNTQIDKWFTTIAVMENVOVAXWZVIGAANRSMEUIRZZRNIANSWHNVDMRUZANNVHJOUMRDZANYWOVVHTXDJNGLLEZHTMDLLZQDJBEWAMROEAXTQIEIWZQYVMRJHOUBRDKSZYVHNANICOVDJVXKQQBNVONHLVXQBDJVPKLDJNBTIUTOVSIJQYDRFSWHTTMEOYHAXEOWNYDTQIDKWRWWOCIBKIEHNVDEATQEMSOTQYVWUOUSOXJQJMDYHELIEGCTPWGBFRZRPQBRFZRTIKWIEMDTQUTOLBLWJYVUAZQDJMNXNHFPHOJQQVQZHTQEYGDHNBVMDEZEUQQTIUTCTMRDJFJJNJUCWMMLXUXTQYUHTMRXPGDFTRWDJMRLXVAQEYEINUCSHABGVIWSOWZQBKEWMHNTQIEZAQWHLOJANXAIERSMEISSQTQQRWAUGSOTZUCJFKUTQMDDJIWETXAIPFCEHQETOCEZRGTKLDJZHJQCREXIMTQMDKLOWCSPAMEFPLDLLTILLUIOUECDJHTDBAUYVTQMDLVOVSVGGQJKLWFIQQBVGDJWGBFCTUTYHDJJDTJFJIDTZAXTQUTQFKBXPORMNPNLXBXTIUTTQMRKYHKSGPPZNLDXPCVSZYVTQYUHTMRXPGDRWDJYDSGOVCWDPTDHTTQMDCAIPZNCAIPHTOERFEZWNYDAOSWNVVVRFXNOVDJPUUXTQMDCFOUMDNVLUOUYDBLGUECUHPAIHPFOVUTOVHTJHXBUXEYZRXXMBQJTQUTANLXVPFJVPMGZEYVCCIMOLMEHNPUQOPPMQQEXJRWDJUMHGMRHAYDVPDBAUOEKWIDWAYRKCZQCRDJTPOV{% endcapture %}
{% capture wuthering_vignere %}IKGWERTZONXEULTEZWHWXTYHSZKEGQOJNENRUDJGFRNKUISLDZOMKDKWZHVUOSJLFZEJJONQHWVRFEATRYIDIKKDKKEHNAEWOEYFIRMLNIENIFMAJKELXAMHRKKDKKEEUOIVADUNVRNLNEERNKKNJHHWNAUKESXDYLSHGRVQTKGNUFOEVAELOFYRVSESZYVWSLOLCLDGTTCLKWHEZQGGATZQTZKDRUKFUWRQDAJOEWLAQESHIFMLVITTEMPVEDLIEWHAYGILMZUUJHIUGNERTZKLGLTAYHROLTKGCDDONEEWHWELVDVWOTRQDKNIWWTGZHVJRSTGVWHWEAIHGGONXWOLNEXUAFMEKKEFOSRLDQKSRQSOKRVGMJYDVDNSYSFRNSYTYHYSXEDDRJOEUDNVZHRWWARLSHOFTENBESXSUDYSTDNKOOOLCOINKHVUELNEEZHQPOJHPZCICOTSQETDRWUFKKEZUUJHAFJPVUHSVSROAVZOBHEHNIDFOEVAEBTZKYNLLDRIMHIFZHVNILIHVQAFJTYHRWYTNLLDHEJKULAPWRRLNELVEGLSLFHYNOJWSSYCYROKKTFLNZGBZWILOOSVEJBEUQOEXLFFKOUOUVAAJNVOLQYHRNIFMHVUHWGDZEEDOEMHTZKDVDDSXERWPWGCVEULOTZVNGZRZJHLZOJSESQOWWHWSWZWHDKVZWYSZTYDTEUMVQTLNEXDRVKNXDTWYWLQGLUTYHRSSBCHRKCEIHRWZUIQIFMTYHYSXERIRSODFINGZHZQGAMRLPBDKDNDTUNIEJTZKIIDPHXORFHLNRFXGZZHVZIFJONWOYKTYHRLNEPZOMRDSUANKSRWAFGNUDLDNIJOEYOOEVAKZHVBSLKPGHDGTTFWHWJOFUSLUNVVAFJHROTWJTFWACKACDSLROFNALZHVPOGTOIPOJKCFURWITCBALKATKOLNEIEYZKRCLGZZIWHLLORIHSAYTZELQOMGHLDKDKREKIAGHTZKMRJAATAEGPJKSJLNYGRVPEEHRRQCWONKRTZKHRQDGLMIVDWGNRQDVOSIHGSXDZQGZKRVAPGYTLOALOOEVALSYIXDWTEJVINGNZVHWJTYUOMMHKKECOTTKEFGSKKEQUPVQEVZHVKOMYEUROJGNUVOKNOLODZGVVFOFLIIPEVPOJHPZONYLSGVIELOFUFYLSXKLCRWKKRMDNLYGRBIFJIJFRWZIFQSZGDYHNGZFFUTMTAKHLQXETRGFOSVGMWLOIDRWYPVFTSHLVFHSXATWEJHYKKEKCEVWRATGFIAKUVVUEAMNRWHAYFVHTEEWROKZUMVZAKREEJTZKNVGBQGDZYEJYIFQIFZHVGIJKCKLOFUFKKECORBZHWTBVQESZHZWSOGLCVIHKRTHINKDUHCSEHRGMSJEGUOYXEJVENKNZQSWBEEPOFZHJPAFEANLNVUWJKOOKDSOAUQGRSSVKPILVWJOWJLSYSRQDKRAKHSBATKHDGLFYHRWGNUWHWXESHYGTDKKEJOGYWLATEFITZKRFRFLUBVJRSJUROLQCOINEVUFWLNUUMZQGSATLPNKZOIPSAYOLJHLGNUVOGTDZVCGBEIHDLNEKKRWKHVDDKZOEHSGTTYHSDUPVQEPZTYHMGURKKEEODUOEGTEXUEQGNUKADLBLUIWJIEKESZHVGGSXLZQTGTSFQLQNAIPOFOZVGBQZHVWUJLAEGMGYSTUEWVIEJUHOTJIOGZHVDTZILZIFKYTZOLTGRVLLATGVUEVXOLQDLNEDXNVKRKKALHEELGFYKPZALIHVGTZKMFWHKLLLWTWXIEJAEUNXWHWNERWHSTDYDRWHECOSDOSKHNWJTFWHWYOWWWATDSUESZHZQGLNRFXGZZHVJRSYSRQDOUNUHRWJHFZAFEOEHCGALUHVWXIDDGATELQQMOEKVLMSBVUSXURKKEKREVSEJYIEWHSZQLLELKAIWH{% endcapture %}
{% capture declaration_caesar_rect %}LDPOUOUJALYVLBZOVTMBLHLUCZUAAPJITLVULJZLZLYZHVFVMYWUVLLLWVSAZKVPZLSOCAVLPWSJASPHUIZHKPDOOJCOJHLUVJULKAOLADLATPUOAHVYOULHVKZAHTZHBLUTAVNWODLVZLMYVLAHOLOYOAALLHZWAYHHLLUBKXZHHSAVAAPUOVJDPOOSALZHMDVAUYHBULVHKHMBUAZYVLNUKPLALAOSAHLLTKUJYLAWLJZLVAOAAWLUVPUPVVZHMRTUKPLUYPXLBYOZAAHLAZOFBOKVSJKHLSAYLLOBJLHZOZJDPTOLPWOSTALAALVOWZYLHPHUAVODSLVOKZALYLAABAOIZVLLMZSPLLCKAUHAOSATHSHLLUYLJAYHLLBKXAHHSOOAFALLHUYLDKKVLAILFOJPLYYVHDAYOPLAJHYUAPHBPUSHLSUIPLOYNAAHZOTAUHVONZALYLSHLLPPMSYIFLAKHOUABLZWYABMPVWOPHWZUALZAOVHAJZYLBOLZALPLOYNNACZVULLYTZUYAHULAPZBPLAATKUHVLNKTUPLPYCAULNOQPZYBVALWDMYVZYOTJALZVUULMAOVAVLLNCLYAUKAOOHDLLLUCUYMHFTVMYVCNYVLLUATUJITLVKLZZLBAAYJLPMCVLALOZKLPUZZAOPAPLOYNMAOVALLWWVASHLVLSVAYVYIAHPVOSZHPKAUPAZVUAAAPBLLNUDLVUCYUTSLAPHNFUZPVAMKBAUHUPUVVJZWBOUYPPJLWHSZVUNKYPHPUGPUZNADWYVLUZBPZMJYOVZTVHALAZOTSOZHSTLVLTSZRAPFLVSAMLJMLOAPALHYLZMHAKFUWOPHWZUWLZKYUBLPJKLUKLPLDKSJSPAAAHLAOVHNYCTLUALSUZNVZULIAPHSLZZOKBOKVSAULVIHJNOUMLYKVNSAPOKHYUAZHLUPJUBAHZZULHJKVHJPYNKUHSSFSWLYELUPLLJAOZHODOALUAOHHTPUKRULHVYTKYZLPZWKVLZAMVBYMOLDLPCSLZPYSHBLMZMHLSYIOLUAHYANVPAOLAOLTCZSILHZFSIZVPUOAPNMOYLVATDZVJOAPOFOYLHJLBHJVZLATBKDIAUOSLHNVYUAUHMPVBHLIZUZBHKYZHBWVAZPUYWBBZNPUUPYCHHPFIOSAHLLZTQVJILCAULPZJKLHPLUZNYAKVLLBOJABLKTUHLZYIBVLSAZKVLWZAPPTZAOPAYLPPYANAOPAPLZOKPAYBVFOAADYMVVBMOZJCNYVLLUATUKHVUAVWPYCUKDLLHNKBYVZAMYPOMLYBBLAYJZYLBFPBAZOJZOHLIALUWOALHUPZLAMBYMLJHVULOMZALVLVJSLUHPZZUJKBZOVPUODUALLLZJZFPOADOPVJJAUHZYZPOUAALHTVLSAAYPOMLYTVYYLZZLFAVTNZMLVUCYUTALAOOZLPYAVVFOMWALZYULLPANRUNVLMYIHPAYPAPHUOZZHPYAVVFLMLYWLHPAKBUPQYHLKZUBBWZYPHUAVSZOHSPHNCUKPYUPALIJVJQALALOALZSHZIPLOATUHVHMUVIBZSAAYLFUHVUFYCOLALLAZZLHAAZYVCWVOLZAPASHLMZJLAIIZPBTLAAAKJVUHHKKVPDKYLSOZOLHYZMKBLZOZPHUZALAHVZSDLAVOTDZVAOZSTLVULUHKLLZJZFHVYMOYWALSBJIPVNOVKHLMOZIVKYPUKPLOVZLNCVYZUYWAZVHHZZSDPVTMTPLAKHULWHKZYPLZPUWNTAVUYHBJSLUZLBZZLZKWUPLAKUPOVLYYWALHUPPVAOSZSPZHUZLOABZVISVKLHIUAPHLKKULDZOUBVWZZKLKULOOZLHABYALUSNFLJSLLAVKAAHUAALKOVTALOOZLHMYZLBALWKVZHAZVYOHLSMDYZVLAJOHTJVVTAKVHPMUHVSLYPNKYZJAPVAWZMWLLVSSBZULOZZAVLLWWVDSBLVYSSKLXPPUBAZLOONYAPOYVWMLZYULLAAVHPUUOPALLPSNHZBSAHYPLYANUOPALTZPSHAILOVTALKHVUMPYHTKLIVSAYAUFHVASZULFHOOHZSJSALNKVOLYALNSZLPASCHPVLPIKHLWZAJSZHLBBBUZBHJSUMVYTVIALHSKHPUKHZAAUVMAYTKOWLLPVVZAVYAFMPOWLYSBJIPJYYLVMKYZVLAVOZWSYLBZWVVLHMPMAPNNBULAPOTVUVAJSTHWPLUPJDOAZOPHTBLZZYLLOZOPHKVZCZSYLWKLZYULLAACHPVLZOBYLWZLALKHLMSYFVWVZWVNPPUDTAUOHMSYFPLTZUZZOUPPZCVHPVUAZUYONLPZOMAVLALOWSVOWLHLYOZBLLMZVKHMYUSAVNLPMTHYABLZKJZOPSZAVBUPAVZHVZJBALLVOAYIZVSLJLLKAOLDLLFYILALOSZNHPSCAWPLLVZDYJPWUHSHVILUMPHUSOAPHUPHVOYCALLUBKYLAALVOVWSLWALHHSLYVNMOYPALEYYLLZJAPLZOHLAYATLLUHUPPUNOPALLUTHTALPLVELWZVKSAHOSKALNHYULMZUVPZCVHPYUTMVADVPOHBKAUUJBVCPSUZVPZODAOPOULLHKZUCLBHVKYVLALWLYCAULAOWWSVBPHUAVAVLMOZZHLAZAVLMOYAAHYWVBWVZZLIBAAYJNPOUAHLZSDYMHVUYASBHHPPGAVVMUMLVNYPYUYLZBLPMZAUWNVZHAZVYOALZUVVLJHBLYNLAYOPNTHPYVAZPUAOLPOUYYHKZHUPPONJALKVAUPUPVVZLMHUDYWWWVHYPPAZVMUVUSZHKOOZLHZVYIAABKJLLAKOHUTZPPHAPYAVVQUMABJZPFLLIYZMUBPPNHOZLZAZUSADVHVZLMYHZSAIOPUZPBNPQKHJFPYDWYVLLZHOOHZLTKKQLBNLZLKWLUAKUOVZUPSDHPSUSMVLAVLYOUAYLBMLOVAYLMPVJMZPLKHOUATLBHVHUKAUFWLHTVUAAMPOZLYHHPSYOLOZLLHLZYLJHAKSTPBAKAVBLLMVUDPMLMJUZZHKALPUOLAZOYYDZHTVVMMMLPZJYOAYVHZYVHZWBVYLLWUSHHKVLAABLAOZPIYBHZJAULLHOOLZARWVHNTUPBAZULPVTZLMJWHALUZHUKHPNPYZTLADVPOABLAOUJLVZVUVAMSBNYLSPAZHLBOYZHLHOZLMAMJALYKVKLYULLAPOTASYPHUFLPKUWLLKVUHAMZUWKBPLYYVAALVOCJSPPDWYVLOOZLHTJPVIKUPLDVAOOAZLVYAIZLBQBJAAZQVYHBKPJZPVAMPULVNYPVUBAVVYZJUAAAPBUPUVHUKJBHVRSUDNLKKLVIYFBDSNHZPPNCUZOZPHUZALAOVPALJYZHAWVLMYUALLKLKPSNHZPSAMVYUVHXABYPLNYUYSLHNKILVPMZYVHKTYLAWVHVZUTBVNVZWMYAYJVLUAAPNTOFLIVHRTJPASYHVMWYTPBOUZUTMLAHVFYUYTLBKDYPZOAJLOOOFBZVJSTKVATUPVLAUOPIOAHPAHVUZOMZALALAZHMLYZVAJPBAVUMNMYVYBALHPKDHASOSYWZHAAVLMOYDKVSYMTVPZWUVPHNLAEUZZVBADVPOVBYABUJLVZMUYAVWKPLYUCBPNUZHPTJUZFHVLAZMIOULLPLZMAAVPMYIHQSFFBVYMYYUAHVZAWYNPZUBFIULVLKZZHIAAVLLYMPKWVLYYUALLKMKLVMLUMJZHVVYIZSPPOAULNOLMZYLAFTZLLVNMUZSSPOZHUDPLHNUPVOYIBNPYUWPVJCUZLHLAPIOSZNPOUALLUYPHHIUYYPYAHVFLNCTYUULUALHKHUNSYNPAUPVZUIBYKLHPVZZZHYAUVLYKALPVHJAUULEHLWHLTSKHPUMUAAPZTYUBLVAPMYYUKAVPBNJULAHOZHTZLIBVLSASYPBLVUOAALLVZJUSLVPVZAMYPHNRUHHVDFJBHYOLYZAYVHPISPZNOUYVVBTCZSAHIBLHSDSHHZHUAKSPLNYUUMHBKUTHLAFSOSAVLTMYMZBVVVYLNCTYUULMAYZVZZLBWPUNKUYVDBVLUPSNHZBSAZYULHLKSKJPHNYULAZOTCLZSLCPZULKAPLDWADOVALSYVPLSNZLHVAMZYUBPSHHSJZZOLDZHLAVYCLLOZOIHHJKAPHNLCKVULLYTOUYALFLLIKHJPSYBUVNZVBOAMWPVZYJAPLAHVKUUNDUHPHNHDYPNZHUZALBOZOSHWKBYULVLYKBHZYLZHHLCNBKJVYZVZHAYIABUYVVBAZDUUHLKAKZFYKVLLAPOSZCMLVYVLBWSVOWLZLAPHPAAOZLPYTAZHVUWPYNAUYSLHNTHLYPMZVVMPYULNYTLLJYULHPVZVAJSTHWLOADALRVVYZLMAKHLOVKZASVHPUUAHKHFUYUSFLHYFHLKIUNPBDJAYOPTJABZJHZULJVBMYALWSFMLKYPJFYZHSJWLFHHSYSLLPSKOUTALAVHZIHYVIYHBLZNUZAHKHVSASUFVBDOYAAFOOHLLMKJVHPPPCSKGHLUVAOPUHLJOZZVYUAUHKPLYVLBMVSJSDPPLAGAURZHJLWUHCAVPLOUOALOPLNZAHIZVYLYHHHTHZNZPAUAPOJLYUVYBAVFLAITJAVLLOLLEAJVBPYUVLZOMPALYYLMPZUUKHYKAILLOVYUVYHAMASLSOLTCZSILAZFPOOLYKHOUZHLLOZPELJAVKLKTPZPAJBUYZYALVJPHUVZTZUBNAUZOHKLHKZUCLBHVKYVLAPINYUAVLUOOPIUHHPAAUMZBVVYYUMVLAZPYLALOTPYLJSPZKZUUPHHZNCZHLVDLOZVRUUDSYVBLHMMDYLHZYPBHKUUAPUZPPNOBZKLZKLBAAYJUPMVVSHNSHZLEZLHLKZUUJPVKVAZPULPLUCZYHFAVNALMZOVLLYWZWLVZZPUODCLHLLPWAVALPUVKYMYYLZKLUZOPAVLATZTOSBILLTAYBZYVYLLAWHWLAKLPPUAVHZLOCLIHLUDUYZLVLSKUFFLIYHWLLAUKBPQHYYFWJPDULZOJVLYOJHHYAZLPBATOZRHKYLLILFCHYAFJPDOOJFTLHKUMHPLYAUFHZAUPBAMVPAAILLOSYYBLHVYMMWLVLLLWVSUHYLOCIDLLLHUADUNPUUPAHUALVAZPUVAYVBPIAYAOPYZIOLLAYLUHDODCYLHKUOLAMLVTYPTLATAATVPMLAVHTAALWFZOIAYLLPSZNHPSYAABLEVLLAHUBKUHUYDYAHIUHQSYLBKPJZPVAVPUYCZLBODCLHLLPYTLUAKKTOMLVLAPOJBYZJTUALHJMZBVVTYNLPAYVHPUUZHKALLASUTOLALLLYDCOHHLLWSWHALAKVPOULYPHLACZQPBAHJKLUNTHHUTUAPPUFDHKHLLOCUJBVQKYOLAILATFAOLLPMZBVVVYTJTRVUUPLKAYKPVHKZDCOVALLZZBWBAYHUPDVZJODPOSVPBKCUALPSHPIFLUYAYABBWVVYUJUALVJPHUKZUYJLVYVZKWUJLAULFOVLAHVLOCLIKLUMLVHALAVOCLPMJVZQPBAHJKLUJVUMVUZBHNPPFUATDZLBOAYALVLLMYXHPJBJLPZLOUUALLLZJZFPOADOPLJKBUJVUVLYZBWZYLHPHUAVKHVUOASLKOZTLHDSOAVKYOZLLMAHVTPUKRULLPUTPLDZUPHWYUJLMHLLYKPULZODALLVYMAYLLOWYLLYUZHLACAZPLAVLMOPBLUAAKAZHVLHZMYTJLPUHLPNYUSLHUJYVNZLZZHTZSLIHLWKWSLUHPVNOAABLYZWLLBTQLKMNVLAVODKYVSMOYYALALAJPLBMKVYVUBPUAPLAZVVUKAPLUOTUHHLIUHKFOBYAVFPMAVLAVONWVVKLLWMSVLALOZSJUVVZPVLZTSSLUBFSWIOPUZHLKSKJLHOYAAHLAOBZPLUKAVLJUSLVPYZHHLVUYKMOPVNAOBANALVYIMHLKLUKPWULKLUULAAAZHALHZOOAFALLHIYHSZLVCYKTMVSHSSHNSHLPLUVJALAYOIPPOAZVJUYDKHOUAHHSASSWAVPHPJJSUVJULVAIPUDLLALOUTALKHOUAALAZHMLYVNALYHIHPUAPHPKZUNVABOIAAVLHVSASPFZKZCVKSLKHOUAHHMAZLYULHUKLPKUWLLKZUHAAZAOLAOLCFHBLSMSDWYVLSACVLHFJDYJVBUSWKHLLJJULVHAAYJSHHSPLULJZHZSAIOPVZJLTJTYULAHKVVSKHASLVOJYZHAKHOUANPDUZJOPPOLULKWLUAKUHZLAAHZVTFPMOYNVAUKHVKAMYZOWLBYWVVAOMZAPJKHLSAYVHPPUODAPHTMYSYHLPLUUJVLAYOWLVAAJUPMVVCKUPPYLCWVLPJKULLBDTHASBSSFKWLANLLVOHAJVYOBLVPYLSCBZMVYAVUYBHLKZUYVHBZLJOYKVVFUY{% endcapture %}

<div class="element">
<span class="label">Exercise</span>
Here are several ciphertexts that were encrypted using unknown ciphers. For which of them do you think that the encryption process may have involved a non-simple substitution? Calculate indices of coincidence and explain your reasoning. 

Ciphertext 1: 
<textarea readonly rows=10 style="width: 100%;">{{ villette_simple }}</textarea>

Ciphertext 2: 
<textarea readonly rows=10 style="width: 100%;">{{ gatsby_hill }}</textarea>

Ciphertext 3: 
<textarea readonly rows=10 style="width: 100%;">{{ wuthering_vignere }}</textarea>

Ciphertext 4: 
<textarea readonly rows=10 style="width: 100%;">{{ declaration_caesar_rect }}</textarea>
</div>

<div class="element">
<span class="label">Harder Exercise</span>
Try decrypting the ciphertexts from the previous exercise for which you decided that the encryption process did not involve a non-simple substitution! (At least one of these won't be very easy.)
</div>

<div class="element">
<span class="label">(Harder?) Sage Exercise</span>
Do you speak a language other than English? If so, edit the code above and replace the sample texts in order to find out what the typical index of coincidence is for that language! 

Depending on what language you decide to work with, the code might involve varying amounts of editing. Here are some example remarks: 

* (German) The German alphabet has 30 distinct letters (the 26 used in English, plus `√Ñ`, `√ñ`, `√ú`, and `·∫û`). This should not require too much editing. 
* (French) The typical framing used for French is that there are just 26 letters in the alphabet. The many types of diacritics (*accent aigu, accent grave, accent circonflexe, tr√©ma, et c√©dille*) are not regarded as creating separate letters, so you will need to be careful about all of this. 
* (Spanish) You'll want to be careful about dealing with `√ë` (which is regarded as a separate 27th letter of the alphabet) and with the *acento agudo* (which is *not* regarded as creating separate letters). 
* (Mandarin) Note that defining the index of coincidence requires specifying the number of characters in the writing system. This means that you'll need to begin by specifying some finite list of possible characters.
* (Korean) You will want to decide whether you want to keep each syllable intact, or if you want to break each syllable up into its constituent consonant and vowel symbols. 
* I do not know how to make sense of the index of coincidence for languages which use an [abugida](https://en.wikipedia.org/wiki/Abugida) (eg, Bengali, Nepali, Thai, Tamil, etc). Should the vowel diacritics be separated from the consonants onto which they attach? If so, should they be counted separately from the "independent" vowel forms? You'll have to first make decisions about questions like these if you want to work with such a language. 

</div>
