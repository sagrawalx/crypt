The *masonic cipher* (also called the *pigpen cipher* or the *tic-tac-toe cipher*) is a simple substitution cipher that replaces individual letters with certain geometric shapes. It is called the masonic cipher because the Freemasons used it very frequently, but it likely [originated](https://en.wikipedia.org/wiki/Pigpen_cipher#History) with Hebrew rabbis. The encryption and decryption scheme of this cipher is described by the following diagram. 

<figure style="text-align: center;">
<svg width="100" height="100">
<line x1="33%" y1="0%" x2="33%" y2="100%"
    stroke="#444" stroke-width="2" />
<line x1="66%" y1="0%" x2="66%" y2="100%"
    stroke="#444" stroke-width="2" />
<line x1="0%" y1="33%" x2="100%" y2="33%"
    stroke="#444" stroke-width="2" />
<line x1="0%" y1="66%" x2="100%" y2="66%"
    stroke="#444" stroke-width="2" />
<text x="16.5%" y="16.5%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    A
</text>
<text x="50%" y="16.5%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    B
</text>
<text x="83.5%" y="16.5%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    C
</text>
<text x="16.5%" y="50%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    D
</text>
<text x="50%" y="50%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    E
</text>
<text x="83.5%" y="50%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    F
</text>
<text x="16.5%" y="83.5%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    G
</text>
<text x="50%" y="83.5%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    H
</text>
<text x="83.5%" y="83.5%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    I
</text>
</svg>
<svg width="100" height="100" style="margin-left: 1em;">
<line x1="33%" y1="0%" x2="33%" y2="100%"
    stroke="#444" stroke-width="2" />
<line x1="66%" y1="0%" x2="66%" y2="100%"
    stroke="#444" stroke-width="2" />
<line x1="0%" y1="33%" x2="100%" y2="33%"
    stroke="#444" stroke-width="2" />
<line x1="0%" y1="66%" x2="100%" y2="66%"
    stroke="#444" stroke-width="2" />
<text x="16.5%" y="16.5%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    J
</text>
<text x="50%" y="16.5%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    K
</text>
<text x="83.5%" y="16.5%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    L
</text>
<text x="16.5%" y="50%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    M
</text>
<text x="50%" y="50%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    N
</text>
<text x="83.5%" y="50%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    O
</text>
<text x="16.5%" y="83.5%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    P
</text>
<text x="50%" y="83.5%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    Q
</text>
<text x="83.5%" y="83.5%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    R
</text>
<circle cx="16.5%" cy="16.5%"  r="5%"
    fill="#444" />
<circle cx="50%" cy="16.5%"  r="5%"
    fill="#444" />
<circle cx="83.5%" cy="16.5%"  r="5%"
    fill="#444" />
<circle cx="16.5%" cy="50%"  r="5%"
    fill="#444" />
<circle cx="50%" cy="50%"  r="5%"
    fill="#444" />
<circle cx="83.5%" cy="50%"  r="5%"
    fill="#444" />
<circle cx="16.5%" cy="83.5%"  r="5%"
    fill="#444" />
<circle cx="50%" cy="83.5%"  r="5%"
    fill="#444" />
<circle cx="83.5%" cy="83.5%"  r="5%"
    fill="#444" />
</svg>
<svg width="100" height="100" style="margin-left: 1em;">
<line x1="0%" y1="0%" x2="100%" y2="100%"
    stroke="#444" stroke-width="2" />
<line x1="100%" y1="0%" x2="0%" y2="100%"
    stroke="#444" stroke-width="2" />
<text x="50%" y="16.5%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    S
</text>
<text x="16.5%" y="50%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    T
</text>
<text x="83.5%" y="50%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    U
</text>
<text x="50%" y="83.5%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    V
</text>
</svg>
<svg width="100" height="100" style="margin-left: 1em;">
<line x1="0%" y1="0%" x2="100%" y2="100%"
    stroke="#444" stroke-width="2" />
<line x1="100%" y1="0%" x2="0%" y2="100%"
    stroke="#444" stroke-width="2" />
<text x="50%" y="16.5%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    W
</text>
<text x="16.5%" y="50%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    X
</text>
<text x="83.5%" y="50%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    Y
</text>
<text x="50%" y="83.5%"
    text-anchor="middle"
    dominant-baseline="middle"
    fill="#ccc"
    font-size="1.5em">
    Z
</text>
<circle cx="50%" cy="16.5%"  r="5%"
    fill="#444" />
<circle cx="16.5%" cy="50%"  r="5%"
    fill="#444" />
<circle cx="83.5%" cy="50%"  r="5%"
    fill="#444" />
<circle cx="50%" cy="83.5%"  r="5%"
    fill="#444" />
</svg>
</figure>
Each letter of the alphabet is replaced by the shape that encloses that letter (possibly including the dot). For example, `A` would be replaced by <svg width="1em" height="1em"><line x1="90%" y1="10%" x2="90%" y2="90%" stroke="#444" stroke-width="1.5" /><line x1="10%" y1="90%" x2="90%" y2="90%" stroke="#444" stroke-width="1.5" /></svg> and `Q` would be replaced by <svg width="1em" height="1em"><line x1="10%" y1="10%" x2="90%" y2="10%" stroke="#444" stroke-width="1.5" /><line x1="10%" y1="10%" x2="10%" y2="90%" stroke="#444" stroke-width="1.5" /><line x1="90%" y1="10%" x2="90%" y2="90%" stroke="#444" stroke-width="1.5" /><circle cx="50%" cy="50%"  r="15%" fill="#444" /></svg> and `U` would be replaced by <svg width="0.6em" height="1em"><line x1="90%" y1="10%" x2="10%" y2="50%" stroke="#444" stroke-width="1.5" /><line x1="10%" y1="50%" x2="90%" y2="90%" stroke="#444" stroke-width="1.5" /></svg>. 

<div class="element">
<span class="label">Exercise</span>
Encrypt the following messages using the masonic cipher: 

a. `MEET AT GEISEL`
b. `BONFIRE AT SUNSET`
</div>

A very similar substitution cipher that replaces letters of the alphabet by geometric shapes is the [Knights Templar Cipher](https://www.dcode.fr/templars-cipher).

Under the attack model we described in the introduction, this cryptosystem is *extremely* insecure. Recall that we typically assume that the adversary knows the decryption function, but does not know the key. For the masonic cipher, there is only a decryption function and no key! This means the adversary, who knows that a message was encrypted using a masonic cipher, can recover the plaintext just as easily as the intended recipient! 

From this point of view, a slightly better simple substitution cipher is the one we discuss next, which at least does have a key.  

